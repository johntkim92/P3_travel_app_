<!DOCTYPE html>
<html ng-app="TravelApp">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.min.js"></script>
    <script src="/lib/js/ng-map.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <%= stylesheet_link_tag 'mapp', media: 'all' %>
    <%= javascript_include_tag 'angular' %>
    <link rel="stylesheet" media="screen"  href="/lib/css/timeline_style.css" />


  </head>
  <body>
      <div ng-controller="mapController">
        <ng-map center="0,0"
                zoom=3
                minZoom=3
                default-style="false"
                zoom-control="true"
                zoom-control-options="{position: 'LEFT_CENTER'}"
                map-type-control="FALSE"
                styles=[{"featureType":"all","elementType":"all","stylers":[{"saturation":-100},{"gamma":0.5}]}]>
              <marker position="-40, 70" on-click="show()"></marker>
                <!-- zoom-to-include-markers="true"
                minZoom=2  -->
          <!-- <marker ng-repeat="trip in trips.trips" position="{{trip.latitude}},{{trip.longitude}}" animation="DROP" title="{{trip.name}}" on-click="show()"></marker> -->


    <!-- John: Angular code -->
    <!-- <header ng-controller="HeaderController as header">
    <h1>Welcome, {{header.current_user.username}}!</h1>
    </header> -->

    <div id="modal">
      <main ng-controller="TripsController as trips" id="temp-overflow">
          <div id="card">
            <div class="back">
              <!-- List of All the Users Trips -->
              <h2>All of your trips</h2>
              <ul>
                <li ng-repeat="trip in trips.current_user_trips">
                  Title: {{trip.title}}
                  Destination: {{trip.destination}}
                  Description: {{trip.description}}
                  Start Date: {{trip.start_date}}
                  End Date: {{trip.end_date}}
                  Tags: {{trip.trip_type}}
                  Notes: {{trip.notes}}
                  Latitude: {{trip.latitude}}
                  Longitude: {{trip.longitude}}
                  <% if #{{trip.user.username}} === #{{trips.current_user.username}} %>
                  <form ng-submit="trips.deleteTrip(trip)">
                    <input type="submit" value="Delete Trip">
                  </form>
                  <br/>
                  <form ng-submit="trips.editTrip(trip)">
                    <input type="text" ng-model="trips.editTripTitle" placeholder="Title" value="{{trip.title}}"/>
                    <input type="text" ng-model="trips.editTripDescription" placeholder="Description" value="{{trip.description}}"/>
                    <input type="date" ng-model="trips.editTripStartDate" placeholder="Start Date"/>
                    <input type="date" ng-model="trips.editTripEndDate" placeholder="End Date"/>
                    <input type="text" ng-model="trips.editTripNotes" placeholder="Notes" value="{{trip.notes}}"/>
                    <input type="submit" value="Edit your Trip"/>
                  </form>
                  <% end %>
                <div ng-controller="CommentsController as commentsCtrl">
                  <h3>Comments:</h3>
                    <ul>
                      <li ng-repeat="comment in trip.comments">
                        Entry: {{comment.entry}}
                        Author: {{comment.commenter}}
                      </li>
                    </ul>
                    <form ng-submit="commentsCtrl.createComment()">
                      <input type="text" ng-model="commentsCtrl.newCommentEntry" placeholder="entry"/>
                      <input type="submit" value="Comment"/>
                    </form>
                  </div>
                </li>
              </ul>
            </div>

            <div class="front">
              <!-- Form to Enter Users Latest Trip -->
              <h2>Where have you been?</h2>
              <form ng-submit="trips.createTrip()">
                <input type="text" ng-model="trips.newTripTitle" placeholder="Title"/>
                <input class="search" places-auto-complete types="['geocode']" on-place-changed="placeChanged()"/>
                <input type="text" ng-model="trips.newTripDescription" placeholder="Description"/>
                <input type="date" ng-model="trips.newTripStartDate" placeholder="Start Date"/>
                <input type="date" ng-model="trips.newTripEndDate" placeholder="End Date"/>
                <input type="text" ng-model="trips.newTripNotes" placeholder="Notes"/>
                <input type="submit" value="Submit your Trip"/>
              </form>
            </div>
          </div>
        </main>
    </div>
    <div class='timeline'>
      <div id="timeline">
        <ul id="dates">
          <li ng-repeat="trip in trips.current_user_trips"><a href="#">{{trip.start_date}}</a></li>
        </ul>

        <ul id="issues">
          <li ng-repeat="trip in trips.current_user_trips" id="?">
            <h1>My Trip to {{trip.destination}}</h1>
          </li>
        </ul>

        <a href="#" id="next">+</a>
        <a href="#" id="prev">-</a>

      </div>
    </div>
  <!-- </main> -->

    <script src="/lib/js/jquery.js"></script>
    <script src="/lib/js/jquery.flip.js"></script>
    <script>
    $(function($) {
      $("#card").flip();
    });
    </script>

    <script>
      $(function(){
        $().timelinr({
          arrowKeys: 'true',
          startAt: 0
        })
      });
    </script>
  </ng-map>
</div>
    <script src="/lib/js/jquery.timelinr-0.9.54.js"></script>
  </body>
</html>
